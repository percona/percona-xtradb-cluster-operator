apiVersion: v1
kind: Secret
metadata:
  name: minio-credentials
type: Opaque
stringData:
  AWS_ACCESS_KEY_ID: minioadmin
  AWS_SECRET_ACCESS_KEY: minioadmin
---
apiVersion: v1
kind: Secret
metadata:
  name: minio-ca-bundle
type: Opaque
data:
  tls.crt: "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUZXekNDQTBPZ0F3SUJBZ0lVYjdoU3U2cUU3U05sL0F5eXd5cm1qRWIrR1pzd0RRWUpLb1pJaHZjTkFRRUwKQlFBd0tERW1NQ1FHQTFVRUF3d2RiV2x1YVc4dWJXbHVhVzh1YzNaakxtTnNkWE4wWlhJdWJHOWpZV3d3SGhjTgpNalF3TlRBM01USXhPRFV6V2hjTk16UXdOVEExTVRJeE9EVXpXakFvTVNZd0pBWURWUVFEREIxdGFXNXBieTV0CmFXNXBieTV6ZG1NdVkyeDFjM1JsY2k1c2IyTmhiRENDQWlJd0RRWUpLb1pJaHZjTkFRRUJCUUFEZ2dJUEFEQ0MKQWdvQ2dnSUJBTkMxalVGaFZkYXBtb2MrbGpzMnRPS1M4bXFGT0pSNUx6K2FyM3QyM1lBTW9wU1lHNlNLYjBMegpPeTM4eS9RS0I1SlRWL1BEbm9QaEFOWkE0QjZmalZDMGZTWkxHWFl4aVRDQzdhTS90SVN1TFNBNmVSNHgwUmpFCjhLUk50dEJMVm91a2RMdmRjNktkT1FEMkdWSVhQNHBnZDBiV2RMVWdPaUQxdjlvSk9mTUdrYlhPenJ6bFE2NkYKTlEwUEQvOVNMUjVZVjB0UDhxU1ZlNWFOVXdQNG5ZWUFwSHhiTTVucEFnK2xvNnBDUXQ1WnNzbmtWZWF1Q29FcwpGcjlJemNqakhxSlJ4c0taZU1UOG5wYXZEalBpVE5MYUh0VDRQTWpOTE56RmwxcC80S1UwUVhBa09OS2tHVzVjCll5N0U0S3JBRHE0VEo4Tis5cXZNRjVwdlRHbkF3OGNMbDlibE1rUnNpM0ZaNlJBLzhob1dtTkkzeCtEV1BxdHYKSEpQcmlNMVU2K1dBNkRUa3dtNWVWL2hCd3pnTkR5ek5MODlpcm9ocjNBQitqMEQyY25uLzJ1S2p5T3BzU2g4OApsZlcxK3kzNklUMlBlVnBFREpMM285eTVmV1JhQ3Y4bVZSQmNERUU4elZwckNCc0ZYbWlIWkhLSWJSWlRQYUF2CjIxNWpkbnhsbEdoNEZWcUxFTDlCNVpKUERwSDUvM2pYenB1bjQ1U05SNjIrM0lWT2tTRkZRVmthUG00d1AxZkYKQ0diejdZY1JYU0hETW1wd2pDenBGaVpGNzlrbzdCa3laWHBYYm81bXlVVzJKSjdlS29IWWt1emh3NWJFeitjSQppSERtb285eFplcGVrZGNLYnpUSWZTa3NSOHlGdnJsUUFBUE1Cd21GRlpwYjdWeGIvV1ViQWdNQkFBR2pmVEI3Ck1CMEdBMVVkRGdRV0JCU0FQOGtkR0UrNGZubUJHZmZGWEtKWE9zd2xuekFmQmdOVkhTTUVHREFXZ0JTQVA4a2QKR0UrNGZubUJHZmZGWEtKWE9zd2xuekFQQmdOVkhSTUJBZjhFQlRBREFRSC9NQ2dHQTFVZEVRUWhNQitDSFcxcApibWx2TG0xcGJtbHZMbk4yWXk1amJIVnpkR1Z5TG14dlkyRnNNQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUNBUURICnkwVHozd1hxTnhnVGtIY0wvRWdqdDFxNDQ4THdkN285d2NFWDRXVGxHNkRYVHlMTnBNczZYZ0E1QjJDQkpkdnoKcU1nVkE2TzNIVzdNOUQ5Tnlka3dRZWcyL3p3MDVyWWxmamY1alZzSklGKzJVLzBuZW9FbWp6QzNEdmxtN25MVwpRVHhWd3BCNklyVVk2VzRRMlhQL0hraStySVhnNXFHQ1VoL0Zkdi9DMTZBMDBjWmtURmp6dmZaZHJObllUVnp3Clh5OWtWUnFabFZiL0RxRDRmVkFTeVJlRCt0L09qTnhPbUZVb1krUGU4NUF4aVE1azk3MVpleHdwakUvYW9RZ0MKTW9hWWw1NFVZU21NM01wT0ZuSTl4U2QvOTJGVW1KemljdXB2SzA3RDZjYWJvM0lEMFNiV3ZxN2tLSDNUaFFFWgpOdzY0bXVzdERUSVB0emVlc3YwMXdmMGVWQXJNZW5QcEZENXc3MWw3ai9yK0swR2drYXliNHdkMzhjUEhWRDJlCjFCYU9CSjNXa29VL3VaY3lwbTl0S0llU0pvd0g2OW82QlhOWXVsOHlHVHBzam1YV1NBNG9Ybm41VEI1Q2tLUTgKS1c4Yks4SnJIQ0MyYWMzUi91OGdTaUxrQ0NlT1Rla05CUmkzMnlZMGFPVFlqY2oxRURFWnNHM3h4MUhPb21hcQpFZHY1amcxRWIxUW1WeE1JNm4zYTZncTVpbW1GTkhJNTlGYWVGTEwvd1hERUYxUTdRbFV3R0ZienplZnpqN1ZyCnF6WVFxYitpYnFBdnFxOU9tc1lGRGRTKzY4S201aStDMDZFckgyWDBQVmR3L0pHSnMxOTZxcXdHOElodDB1V28KN25GYTNuYmtBTStuckViQ1lzSS9RZlcyQ1BwZHlGbG1NaDFOTkxCVldBPT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo="
---
apiVersion: pxc.percona.com/v1
kind: PerconaXtraDBCluster
metadata:
  name: minimal-cluster
spec:
  crVersion: 1.18.0
  initContainer:
    image: k3d-registry:5000/pxc-operator:K8SPXC-1332
  secretsName: minimal-cluster-secrets
  unsafeFlags:
    tls: true
    pxcSize: true
    proxySize: true
  upgradeOptions:
    apply: disabled
    schedule: "0 4 * * *"
  tls:
    enabled: false
  pxc:
    size: 1
    image: perconalab/percona-xtradb-cluster-operator:main-pxc8.0
    volumeSpec:
      persistentVolumeClaim:
        resources:
          requests:
            storage: 6G
  backup:
    image: percona/percona-xtrabackup
    storages:
      minio-s3:
        type: s3
        verifyTLS: true
        s3:
          bucket: everest-operator
          endpointUrl: https://minio.minio.svc.cluster.local
          region: us-east-1
          credentialsSecret: minio-credentials
          caBundle: "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUZXekNDQTBPZ0F3SUJBZ0lVYjdoU3U2cUU3U05sL0F5eXd5cm1qRWIrR1pzd0RRWUpLb1pJaHZjTkFRRUwKQlFBd0tERW1NQ1FHQTFVRUF3d2RiV2x1YVc4dWJXbHVhVzh1YzNaakxtTnNkWE4wWlhJdWJHOWpZV3d3SGhjTgpNalF3TlRBM01USXhPRFV6V2hjTk16UXdOVEExTVRJeE9EVXpXakFvTVNZd0pBWURWUVFEREIxdGFXNXBieTV0CmFXNXBieTV6ZG1NdVkyeDFjM1JsY2k1c2IyTmhiRENDQWlJd0RRWUpLb1pJaHZjTkFRRUJCUUFEZ2dJUEFEQ0MKQWdvQ2dnSUJBTkMxalVGaFZkYXBtb2MrbGpzMnRPS1M4bXFGT0pSNUx6K2FyM3QyM1lBTW9wU1lHNlNLYjBMegpPeTM4eS9RS0I1SlRWL1BEbm9QaEFOWkE0QjZmalZDMGZTWkxHWFl4aVRDQzdhTS90SVN1TFNBNmVSNHgwUmpFCjhLUk50dEJMVm91a2RMdmRjNktkT1FEMkdWSVhQNHBnZDBiV2RMVWdPaUQxdjlvSk9mTUdrYlhPenJ6bFE2NkYKTlEwUEQvOVNMUjVZVjB0UDhxU1ZlNWFOVXdQNG5ZWUFwSHhiTTVucEFnK2xvNnBDUXQ1WnNzbmtWZWF1Q29FcwpGcjlJemNqakhxSlJ4c0taZU1UOG5wYXZEalBpVE5MYUh0VDRQTWpOTE56RmwxcC80S1UwUVhBa09OS2tHVzVjCll5N0U0S3JBRHE0VEo4Tis5cXZNRjVwdlRHbkF3OGNMbDlibE1rUnNpM0ZaNlJBLzhob1dtTkkzeCtEV1BxdHYKSEpQcmlNMVU2K1dBNkRUa3dtNWVWL2hCd3pnTkR5ek5MODlpcm9ocjNBQitqMEQyY25uLzJ1S2p5T3BzU2g4OApsZlcxK3kzNklUMlBlVnBFREpMM285eTVmV1JhQ3Y4bVZSQmNERUU4elZwckNCc0ZYbWlIWkhLSWJSWlRQYUF2CjIxNWpkbnhsbEdoNEZWcUxFTDlCNVpKUERwSDUvM2pYenB1bjQ1U05SNjIrM0lWT2tTRkZRVmthUG00d1AxZkYKQ0diejdZY1JYU0hETW1wd2pDenBGaVpGNzlrbzdCa3laWHBYYm81bXlVVzJKSjdlS29IWWt1emh3NWJFeitjSQppSERtb285eFplcGVrZGNLYnpUSWZTa3NSOHlGdnJsUUFBUE1Cd21GRlpwYjdWeGIvV1ViQWdNQkFBR2pmVEI3Ck1CMEdBMVVkRGdRV0JCU0FQOGtkR0UrNGZubUJHZmZGWEtKWE9zd2xuekFmQmdOVkhTTUVHREFXZ0JTQVA4a2QKR0UrNGZubUJHZmZGWEtKWE9zd2xuekFQQmdOVkhSTUJBZjhFQlRBREFRSC9NQ2dHQTFVZEVRUWhNQitDSFcxcApibWx2TG0xcGJtbHZMbk4yWXk1amJIVnpkR1Z5TG14dlkyRnNNQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUNBUURICnkwVHozd1hxTnhnVGtIY0wvRWdqdDFxNDQ4THdkN285d2NFWDRXVGxHNkRYVHlMTnBNczZYZ0E1QjJDQkpkdnoKcU1nVkE2TzNIVzdNOUQ5Tnlka3dRZWcyL3p3MDVyWWxmamY1alZzSklGKzJVLzBuZW9FbWp6QzNEdmxtN25MVwpRVHhWd3BCNklyVVk2VzRRMlhQL0hraStySVhnNXFHQ1VoL0Zkdi9DMTZBMDBjWmtURmp6dmZaZHJObllUVnp3Clh5OWtWUnFabFZiL0RxRDRmVkFTeVJlRCt0L09qTnhPbUZVb1krUGU4NUF4aVE1azk3MVpleHdwakUvYW9RZ0MKTW9hWWw1NFVZU21NM01wT0ZuSTl4U2QvOTJGVW1KemljdXB2SzA3RDZjYWJvM0lEMFNiV3ZxN2tLSDNUaFFFWgpOdzY0bXVzdERUSVB0emVlc3YwMXdmMGVWQXJNZW5QcEZENXc3MWw3ai9yK0swR2drYXliNHdkMzhjUEhWRDJlCjFCYU9CSjNXa29VL3VaY3lwbTl0S0llU0pvd0g2OW82QlhOWXVsOHlHVHBzam1YV1NBNG9Ybm41VEI1Q2tLUTgKS1c4Yks4SnJIQ0MyYWMzUi91OGdTaUxrQ0NlT1Rla05CUmkzMnlZMGFPVFlqY2oxRURFWnNHM3h4MUhPb21hcQpFZHY1amcxRWIxUW1WeE1JNm4zYTZncTVpbW1GTkhJNTlGYWVGTEwvd1hERUYxUTdRbFV3R0ZienplZnpqN1ZyCnF6WVFxYitpYnFBdnFxOU9tc1lGRGRTKzY4S201aStDMDZFckgyWDBQVmR3L0pHSnMxOTZxcXdHOElodDB1V28KN25GYTNuYmtBTStuckViQ1lzSS9RZlcyQ1BwZHlGbG1NaDFOTkxCVldBPT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo="
          # caBundle:
          #   fromSecret:
          #     name: minio-ca-bundle
          #     key: tls.crt

    pitr:
      enabled: true
      storageName: minio-s3
      timeBetweenUploads: 60
      timeoutSeconds: 60

  haproxy:
    enabled: true
    size: 1
    image: perconalab/percona-xtradb-cluster-operator:main-haproxy
    resources:
      requests:
        memory: 1G
        cpu: 600m
      limits:
        memory: 1G
        cpu: 600m
